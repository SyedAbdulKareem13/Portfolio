import { Component, Input, isDevMode, ChangeDetectionStrategy, Optional, Inject, } from '@angular/core';
import { NGX_SKELETON_LOADER_CONFIG, } from './ngx-skeleton-loader-config.types';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
class NgxSkeletonLoaderComponent {
    constructor(config) {
        this.config = config;
        const { appearance = 'line', animation = 'progress', theme = null, loadingText = 'Loading...', count = 1, ariaLabel = 'loading', } = config || {};
        this.appearance = appearance;
        this.animation = animation;
        this.theme = theme;
        this.loadingText = loadingText;
        this.count = count;
        this.items = [];
        this.ariaLabel = ariaLabel;
    }
    ngOnInit() {
        this.validateInputValues();
    }
    validateInputValues() {
        // Checking if it's receiving a numeric value (string having ONLY numbers or if it's a number)
        if (!/^\d+$/.test(`${this.count}`)) {
            // Shows error message only in Development
            if (isDevMode()) {
                console.error(`\`NgxSkeletonLoaderComponent\` need to receive 'count' a numeric value. Forcing default to "1".`);
            }
            this.count = 1;
        }
        //Force count to 1 when custom-content is used
        if (this.appearance === 'custom-content') {
            // Shows error message only in Development
            if (isDevMode() && this.count !== 1) {
                console.error(`\`NgxSkeletonLoaderComponent\` enforces elements with "custom-content" appearance as DOM nodes. Forcing "count" to "1".`);
                this.count = 1;
            }
        }
        this.items.length = this.count;
        const allowedAnimations = ['progress', 'progress-dark', 'pulse', 'false'];
        if (allowedAnimations.indexOf(String(this.animation)) === -1) {
            // Shows error message only in Development
            if (isDevMode()) {
                console.error(`\`NgxSkeletonLoaderComponent\` need to receive 'animation' as: ${allowedAnimations.join(', ')}. Forcing default to "progress".`);
            }
            this.animation = 'progress';
        }
        if (['circle', 'line', 'custom-content', ''].indexOf(String(this.appearance)) === -1) {
            // Shows error message only in Development
            if (isDevMode()) {
                console.error(`\`NgxSkeletonLoaderComponent\` need to receive 'appearance' as: circle or line or custom-content or empty string. Forcing default to "''".`);
            }
            this.appearance = '';
        }
        // Optional chaining is only supported on Angular CLI v12
        //  - more details in this comment https://github.com/angular/angular-cli/issues/20471#issuecomment-815599616
        // So the main issue here is on the consumer's side.
        // Options are use v6.0.0 or upgrade your Angular CLI to >= v12, as described in https://github.com/willmendesneto/ngx-skeleton-loader/issues/150#issuecomment-1638612329
        if (Boolean(this.config?.theme?.extendsFromRoot) && this.theme !== null) {
            // Shows error message only in Development
            this.theme = { ...this.config.theme, ...this.theme };
        }
    }
    ngOnChanges(changes) {
        // Avoiding multiple calls for the same input in case there's no changes in the fields
        // Checking if the fields that require validation are available and if they were changed
        // In case were not changed, we stop the function. Otherwise, `validateInputValues` will be called.
        if (['count', 'animation', 'appearance'].find(key => changes[key] && (changes[key].isFirstChange() || changes[key].previousValue === changes[key].currentValue))) {
            return;
        }
        this.validateInputValues();
    }
    /** @nocollapse */ static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.0.0", ngImport: i0, type: NgxSkeletonLoaderComponent, deps: [{ token: NGX_SKELETON_LOADER_CONFIG, optional: true }], target: i0.ɵɵFactoryTarget.Component }); }
    /** @nocollapse */ static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.0.0", type: NgxSkeletonLoaderComponent, selector: "ngx-skeleton-loader", inputs: { count: "count", loadingText: "loadingText", appearance: "appearance", animation: "animation", ariaLabel: "ariaLabel", theme: "theme" }, usesOnChanges: true, ngImport: i0, template: "<div\n  *ngFor=\"let item of items\"\n  class=\"skeleton-loader\"\n  [attr.aria-label]=\"ariaLabel\"\n  aria-busy=\"true\"\n  aria-valuemin=\"0\"\n  aria-valuemax=\"100\"\n  [attr.aria-valuetext]=\"loadingText\"\n  role=\"progressbar\"\n  tabindex=\"-1\"\n  [ngClass]=\"{\n    'custom-content': appearance === 'custom-content',\n    circle: appearance === 'circle',\n    progress: animation === 'progress',\n    'progress-dark': animation === 'progress-dark',\n    pulse: animation === 'pulse'\n  }\"\n  [ngStyle]=\"theme\"\n>\n  <ng-content *ngIf=\"appearance  === 'custom-content'\"></ng-content>\n</div>\n", styles: [".skeleton-loader{box-sizing:border-box;overflow:hidden;position:relative;background:rgb(239,241,246) no-repeat;border-radius:4px;width:100%;height:20px;display:inline-block;margin-bottom:10px;will-change:transform}.skeleton-loader:after,.skeleton-loader:before{box-sizing:border-box}.skeleton-loader.circle{width:40px;height:40px;margin:5px;border-radius:50%}.skeleton-loader.progress,.skeleton-loader.progress-dark{transform:translateZ(0)}.skeleton-loader.progress:after,.skeleton-loader.progress:before,.skeleton-loader.progress-dark:after,.skeleton-loader.progress-dark:before{box-sizing:border-box}.skeleton-loader.progress:before,.skeleton-loader.progress-dark:before{animation:progress 2s ease-in-out infinite;background-size:200px 100%;position:absolute;z-index:1;top:0;left:0;width:200px;height:100%;content:\"\"}.skeleton-loader.progress:before{background-image:linear-gradient(90deg,rgba(255,255,255,0),rgba(255,255,255,.6),rgba(255,255,255,0))}.skeleton-loader.progress-dark:before{background-image:linear-gradient(90deg,transparent,rgba(0,0,0,.2),transparent)}.skeleton-loader.pulse{animation:pulse 1.5s cubic-bezier(.4,0,.2,1) infinite;animation-delay:.5s}.skeleton-loader.custom-content{height:100%;background:none}@media (prefers-reduced-motion: reduce){.skeleton-loader.pulse,.skeleton-loader.progress-dark,.skeleton-loader.custom-content,.skeleton-loader.progress:before{animation:none}.skeleton-loader.progress:before,.skeleton-loader.progress-dark,.skeleton-loader.custom-content{background-image:none}}@media screen and (min-device-width: 1200px){.skeleton-loader{-webkit-user-select:none;user-select:none;cursor:wait}}@keyframes progress{0%{transform:translate3d(-200px,0,0)}to{transform:translate3d(calc(200px + 100vw),0,0)}}@keyframes pulse{0%{opacity:1}50%{opacity:.4}to{opacity:1}}\n"], dependencies: [{ kind: "directive", type: i1.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i1.NgStyle, selector: "[ngStyle]", inputs: ["ngStyle"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
export { NgxSkeletonLoaderComponent };
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.0.0", ngImport: i0, type: NgxSkeletonLoaderComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ngx-skeleton-loader', changeDetection: ChangeDetectionStrategy.OnPush, template: "<div\n  *ngFor=\"let item of items\"\n  class=\"skeleton-loader\"\n  [attr.aria-label]=\"ariaLabel\"\n  aria-busy=\"true\"\n  aria-valuemin=\"0\"\n  aria-valuemax=\"100\"\n  [attr.aria-valuetext]=\"loadingText\"\n  role=\"progressbar\"\n  tabindex=\"-1\"\n  [ngClass]=\"{\n    'custom-content': appearance === 'custom-content',\n    circle: appearance === 'circle',\n    progress: animation === 'progress',\n    'progress-dark': animation === 'progress-dark',\n    pulse: animation === 'pulse'\n  }\"\n  [ngStyle]=\"theme\"\n>\n  <ng-content *ngIf=\"appearance  === 'custom-content'\"></ng-content>\n</div>\n", styles: [".skeleton-loader{box-sizing:border-box;overflow:hidden;position:relative;background:rgb(239,241,246) no-repeat;border-radius:4px;width:100%;height:20px;display:inline-block;margin-bottom:10px;will-change:transform}.skeleton-loader:after,.skeleton-loader:before{box-sizing:border-box}.skeleton-loader.circle{width:40px;height:40px;margin:5px;border-radius:50%}.skeleton-loader.progress,.skeleton-loader.progress-dark{transform:translateZ(0)}.skeleton-loader.progress:after,.skeleton-loader.progress:before,.skeleton-loader.progress-dark:after,.skeleton-loader.progress-dark:before{box-sizing:border-box}.skeleton-loader.progress:before,.skeleton-loader.progress-dark:before{animation:progress 2s ease-in-out infinite;background-size:200px 100%;position:absolute;z-index:1;top:0;left:0;width:200px;height:100%;content:\"\"}.skeleton-loader.progress:before{background-image:linear-gradient(90deg,rgba(255,255,255,0),rgba(255,255,255,.6),rgba(255,255,255,0))}.skeleton-loader.progress-dark:before{background-image:linear-gradient(90deg,transparent,rgba(0,0,0,.2),transparent)}.skeleton-loader.pulse{animation:pulse 1.5s cubic-bezier(.4,0,.2,1) infinite;animation-delay:.5s}.skeleton-loader.custom-content{height:100%;background:none}@media (prefers-reduced-motion: reduce){.skeleton-loader.pulse,.skeleton-loader.progress-dark,.skeleton-loader.custom-content,.skeleton-loader.progress:before{animation:none}.skeleton-loader.progress:before,.skeleton-loader.progress-dark,.skeleton-loader.custom-content{background-image:none}}@media screen and (min-device-width: 1200px){.skeleton-loader{-webkit-user-select:none;user-select:none;cursor:wait}}@keyframes progress{0%{transform:translate3d(-200px,0,0)}to{transform:translate3d(calc(200px + 100vw),0,0)}}@keyframes pulse{0%{opacity:1}50%{opacity:.4}to{opacity:1}}\n"] }]
        }], ctorParameters: function () { return [{ type: undefined, decorators: [{
                    type: Inject,
                    args: [NGX_SKELETON_LOADER_CONFIG]
                }, {
                    type: Optional
                }] }]; }, propDecorators: { count: [{
                type: Input
            }], loadingText: [{
                type: Input
            }], appearance: [{
                type: Input
            }], animation: [{
                type: Input
            }], ariaLabel: [{
                type: Input
            }], theme: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXNrZWxldG9uLWxvYWRlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtc2tlbGV0b24tbG9hZGVyL3NyYy9saWIvbmd4LXNrZWxldG9uLWxvYWRlci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtc2tlbGV0b24tbG9hZGVyL3NyYy9saWIvbmd4LXNrZWxldG9uLWxvYWRlci5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDTCxTQUFTLEVBRVQsS0FBSyxFQUNMLFNBQVMsRUFDVCx1QkFBdUIsRUFHdkIsUUFBUSxFQUNSLE1BQU0sR0FDUCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBR0wsMEJBQTBCLEdBQzNCLE1BQU0sb0NBQW9DLENBQUM7OztBQUU1QyxNQU1hLDBCQUEwQjtJQXdCckMsWUFBb0UsTUFBZ0M7UUFBaEMsV0FBTSxHQUFOLE1BQU0sQ0FBMEI7UUFDbEcsTUFBTSxFQUNKLFVBQVUsR0FBRyxNQUFNLEVBQ25CLFNBQVMsR0FBRyxVQUFVLEVBQ3RCLEtBQUssR0FBRyxJQUFJLEVBQ1osV0FBVyxHQUFHLFlBQVksRUFDMUIsS0FBSyxHQUFHLENBQUMsRUFDVCxTQUFTLEdBQUcsU0FBUyxHQUN0QixHQUFHLE1BQU0sSUFBSSxFQUFFLENBQUM7UUFFakIsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7UUFDN0IsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7UUFDM0IsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDbkIsSUFBSSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUM7UUFDL0IsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDbkIsSUFBSSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUM7UUFDaEIsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7SUFDN0IsQ0FBQztJ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LGtPQ3ZCdkMsa21CQXFCQTs7U0RFYSwwQkFBMEI7MkZBQTFCLDBCQUEwQjtrQkFOdEMsU0FBUzsrQkFDRSxxQkFBcUIsbUJBR2QsdUJBQXVCLENBQUMsTUFBTTs7MEJBMEJsQyxNQUFNOzJCQUFDLDBCQUEwQjs7MEJBQUcsUUFBUTs0Q0FuQnpELEtBQUs7c0JBREosS0FBSztnQkFJTixXQUFXO3NCQURWLEtBQUs7Z0JBSU4sVUFBVTtzQkFEVCxLQUFLO2dCQUlOLFNBQVM7c0JBRFIsS0FBSztnQkFJTixTQUFTO3NCQURSLEtBQUs7Z0JBSU4sS0FBSztzQkFESixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBPbkluaXQsXG4gIElucHV0LFxuICBpc0Rldk1vZGUsXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBPbkNoYW5nZXMsXG4gIFNpbXBsZUNoYW5nZXMsXG4gIE9wdGlvbmFsLFxuICBJbmplY3QsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtcbiAgTmd4U2tlbGV0b25Mb2FkZXJDb25maWcsXG4gIE5neFNrZWxldG9uTG9hZGVyQ29uZmlnVGhlbWUsXG4gIE5HWF9TS0VMRVRPTl9MT0FERVJfQ09ORklHLFxufSBmcm9tICcuL25neC1za2VsZXRvbi1sb2FkZXItY29uZmlnLnR5cGVzJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmd4LXNrZWxldG9uLWxvYWRlcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9uZ3gtc2tlbGV0b24tbG9hZGVyLmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9uZ3gtc2tlbGV0b24tbG9hZGVyLnNjc3MnXSxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG59KVxuZXhwb3J0IGNsYXNzIE5neFNrZWxldG9uTG9hZGVyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xuICBzdGF0aWMgbmdBY2NlcHRJbnB1dFR5cGVfY291bnQ6IG51bWJlciB8IHN0cmluZztcbiAgc3RhdGljIG5nQWNjZXB0SW5wdXRUeXBlX2FuaW1hdGlvbjogYm9vbGVhbiB8IHN0cmluZztcblxuICBASW5wdXQoKVxuICBjb3VudDogTmd4U2tlbGV0b25Mb2FkZXJDb25maWdbJ2NvdW50J107XG5cbiAgQElucHV0KClcbiAgbG9hZGluZ1RleHQ6IE5neFNrZWxldG9uTG9hZGVyQ29uZmlnWydsb2FkaW5nVGV4dCddO1xuXG4gIEBJbnB1dCgpXG4gIGFwcGVhcmFuY2U6IE5neFNrZWxldG9uTG9hZGVyQ29uZmlnWydhcHBlYXJhbmNlJ107XG5cbiAgQElucHV0KClcbiAgYW5pbWF0aW9uOiBOZ3hTa2VsZXRvbkxvYWRlckNvbmZpZ1snYW5pbWF0aW9uJ107XG5cbiAgQElucHV0KClcbiAgYXJpYUxhYmVsOiBOZ3hTa2VsZXRvbkxvYWRlckNvbmZpZ1snYXJpYUxhYmVsJ107XG5cbiAgQElucHV0KClcbiAgdGhlbWU6IE5neFNrZWxldG9uTG9hZGVyQ29uZmlnVGhlbWU7XG5cbiAgaXRlbXM6IEFycmF5PGFueT47XG5cbiAgY29uc3RydWN0b3IoQEluamVjdChOR1hfU0tFTEVUT05fTE9BREVSX0NPTkZJRykgQE9wdGlvbmFsKCkgcHJpdmF0ZSBjb25maWc/OiBOZ3hTa2VsZXRvbkxvYWRlckNvbmZpZykge1xuICAgIGNvbnN0IHtcbiAgICAgIGFwcGVhcmFuY2UgPSAnbGluZScsXG4gICAgICBhbmltYXRpb24gPSAncHJvZ3Jlc3MnLFxuICAgICAgdGhlbWUgPSBudWxsLFxuICAgICAgbG9hZGluZ1RleHQgPSAnTG9hZGluZy4uLicsXG4gICAgICBjb3VudCA9IDEsXG4gICAgICBhcmlhTGFiZWwgPSAnbG9hZGluZycsXG4gICAgfSA9IGNvbmZpZyB8fCB7fTtcblxuICAgIHRoaXMuYXBwZWFyYW5jZSA9IGFwcGVhcmFuY2U7XG4gICAgdGhpcy5hbmltYXRpb24gPSBhbmltYXRpb247XG4gICAgdGhpcy50aGVtZSA9IHRoZW1lO1xuICAgIHRoaXMubG9hZGluZ1RleHQgPSBsb2FkaW5nVGV4dDtcbiAgICB0aGlzLmNvdW50ID0gY291bnQ7XG4gICAgdGhpcy5pdGVtcyA9IFtdO1xuICAgIHRoaXMuYXJpYUxhYmVsID0gYXJpYUxhYmVsO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy52YWxpZGF0ZUlucHV0VmFsdWVzKCk7XG4gIH1cblxuICBwcml2YXRlIHZhbGlkYXRlSW5wdXRWYWx1ZXMoKSB7XG4gICAgLy8gQ2hlY2tpbmcgaWYgaXQncyByZWNlaXZpbmcgYSBudW1lcmljIHZhbHVlIChzdHJpbmcgaGF2aW5nIE9OTFkgbnVtYmVycyBvciBpZiBpdCdzIGEgbnVtYmVyKVxuICAgIGlmICghL15cXGQrJC8udGVzdChgJHt0aGlzLmNvdW50fWApKSB7XG4gICAgICAvLyBTaG93cyBlcnJvciBtZXNzYWdlIG9ubHkgaW4gRGV2ZWxvcG1lbnRcbiAgICAgIGlmIChpc0Rldk1vZGUoKSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICAgIGBcXGBOZ3hTa2VsZXRvbkxvYWRlckNvbXBvbmVudFxcYCBuZWVkIHRvIHJlY2VpdmUgJ2NvdW50JyBhIG51bWVyaWMgdmFsdWUuIEZvcmNpbmcgZGVmYXVsdCB0byBcIjFcIi5gLFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhpcy5jb3VudCA9IDE7XG4gICAgfVxuXG4gICAgLy9Gb3JjZSBjb3VudCB0byAxIHdoZW4gY3VzdG9tLWNvbnRlbnQgaXMgdXNlZFxuICAgIGlmICh0aGlzLmFwcGVhcmFuY2UgPT09ICdjdXN0b20tY29udGVudCcpIHtcbiAgICAgIC8vIFNob3dzIGVycm9yIG1lc3NhZ2Ugb25seSBpbiBEZXZlbG9wbWVudFxuICAgICAgaWYgKGlzRGV2TW9kZSgpICYmIHRoaXMuY291bnQgIT09IDEpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICBgXFxgTmd4U2tlbGV0b25Mb2FkZXJDb21wb25lbnRcXGAgZW5mb3JjZXMgZWxlbWVudHMgd2l0aCBcImN1c3RvbS1jb250ZW50XCIgYXBwZWFyYW5jZSBhcyBET00gbm9kZXMuIEZvcmNpbmcgXCJjb3VudFwiIHRvIFwiMVwiLmAsXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuY291bnQgPSAxO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLml0ZW1zLmxlbmd0aCA9IHRoaXMuY291bnQ7XG5cbiAgICBjb25zdCBhbGxvd2VkQW5pbWF0aW9ucyA9IFsncHJvZ3Jlc3MnLCAncHJvZ3Jlc3MtZGFyaycsICdwdWxzZScsICdmYWxzZSddO1xuICAgIGlmIChhbGxvd2VkQW5pbWF0aW9ucy5pbmRleE9mKFN0cmluZyh0aGlzLmFuaW1hdGlvbikpID09PSAtMSkge1xuICAgICAgLy8gU2hvd3MgZXJyb3IgbWVzc2FnZSBvbmx5IGluIERldmVsb3BtZW50XG4gICAgICBpZiAoaXNEZXZNb2RlKCkpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICBgXFxgTmd4U2tlbGV0b25Mb2FkZXJDb21wb25lbnRcXGAgbmVlZCB0byByZWNlaXZlICdhbmltYXRpb24nIGFzOiAke2FsbG93ZWRBbmltYXRpb25zLmpvaW4oXG4gICAgICAgICAgICAnLCAnLFxuICAgICAgICAgICl9LiBGb3JjaW5nIGRlZmF1bHQgdG8gXCJwcm9ncmVzc1wiLmAsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICB0aGlzLmFuaW1hdGlvbiA9ICdwcm9ncmVzcyc7XG4gICAgfVxuXG4gICAgaWYgKFsnY2lyY2xlJywgJ2xpbmUnLCAnY3VzdG9tLWNvbnRlbnQnLCAnJ10uaW5kZXhPZihTdHJpbmcodGhpcy5hcHBlYXJhbmNlKSkgPT09IC0xKSB7XG4gICAgICAvLyBTaG93cyBlcnJvciBtZXNzYWdlIG9ubHkgaW4gRGV2ZWxvcG1lbnRcbiAgICAgIGlmIChpc0Rldk1vZGUoKSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICAgIGBcXGBOZ3hTa2VsZXRvbkxvYWRlckNvbXBvbmVudFxcYCBuZWVkIHRvIHJlY2VpdmUgJ2FwcGVhcmFuY2UnIGFzOiBjaXJjbGUgb3IgbGluZSBvciBjdXN0b20tY29udGVudCBvciBlbXB0eSBzdHJpbmcuIEZvcmNpbmcgZGVmYXVsdCB0byBcIicnXCIuYCxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuYXBwZWFyYW5jZSA9ICcnO1xuICAgIH1cblxuICAgIC8vIE9wdGlvbmFsIGNoYWluaW5nIGlzIG9ubHkgc3VwcG9ydGVkIG9uIEFuZ3VsYXIgQ0xJIHYxMlxuICAgIC8vICAtIG1vcmUgZGV0YWlscyBpbiB0aGlzIGNvbW1lbnQgaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci1jbGkvaXNzdWVzLzIwNDcxI2lzc3VlY29tbWVudC04MTU1OTk2MTZcbiAgICAvLyBTbyB0aGUgbWFpbiBpc3N1ZSBoZXJlIGlzIG9uIHRoZSBjb25zdW1lcidzIHNpZGUuXG4gICAgLy8gT3B0aW9ucyBhcmUgdXNlIHY2LjAuMCBvciB1cGdyYWRlIHlvdXIgQW5ndWxhciBDTEkgdG8gPj0gdjEyLCBhcyBkZXNjcmliZWQgaW4gaHR0cHM6Ly9naXRodWIuY29tL3dpbGxtZW5kZXNuZXRvL25neC1za2VsZXRvbi1sb2FkZXIvaXNzdWVzLzE1MCNpc3N1ZWNvbW1lbnQtMTYzODYxMjMyOVxuICAgIGlmIChCb29sZWFuKHRoaXMuY29uZmlnPy50aGVtZT8uZXh0ZW5kc0Zyb21Sb290KSAmJiB0aGlzLnRoZW1lICE9PSBudWxsKSB7XG4gICAgICAvLyBTaG93cyBlcnJvciBtZXNzYWdlIG9ubHkgaW4gRGV2ZWxvcG1lbnRcbiAgICAgIHRoaXMudGhlbWUgPSB7IC4uLnRoaXMuY29uZmlnIS50aGVtZSwgLi4udGhpcy50aGVtZSB9O1xuICAgIH1cbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcbiAgICAvLyBBdm9pZGluZyBtdWx0aXBsZSBjYWxscyBmb3IgdGhlIHNhbWUgaW5wdXQgaW4gY2FzZSB0aGVyZSdzIG5vIGNoYW5nZXMgaW4gdGhlIGZpZWxkc1xuICAgIC8vIENoZWNraW5nIGlmIHRoZSBmaWVsZHMgdGhhdCByZXF1aXJlIHZhbGlkYXRpb24gYXJlIGF2YWlsYWJsZSBhbmQgaWYgdGhleSB3ZXJlIGNoYW5nZWRcbiAgICAvLyBJbiBjYXNlIHdlcmUgbm90IGNoYW5nZWQsIHdlIHN0b3AgdGhlIGZ1bmN0aW9uLiBPdGhlcndpc2UsIGB2YWxpZGF0ZUlucHV0VmFsdWVzYCB3aWxsIGJlIGNhbGxlZC5cbiAgICBpZiAoXG4gICAgICBbJ2NvdW50JywgJ2FuaW1hdGlvbicsICdhcHBlYXJhbmNlJ10uZmluZChcbiAgICAgICAga2V5ID0+XG4gICAgICAgICAgY2hhbmdlc1trZXldICYmIChjaGFuZ2VzW2tleV0uaXNGaXJzdENoYW5nZSgpIHx8IGNoYW5nZXNba2V5XS5wcmV2aW91c1ZhbHVlID09PSBjaGFuZ2VzW2tleV0uY3VycmVudFZhbHVlKSxcbiAgICAgIClcbiAgICApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnZhbGlkYXRlSW5wdXRWYWx1ZXMoKTtcbiAgfVxufVxuIiwiPGRpdlxuICAqbmdGb3I9XCJsZXQgaXRlbSBvZiBpdGVtc1wiXG4gIGNsYXNzPVwic2tlbGV0b24tbG9hZGVyXCJcbiAgW2F0dHIuYXJpYS1sYWJlbF09XCJhcmlhTGFiZWxcIlxuICBhcmlhLWJ1c3k9XCJ0cnVlXCJcbiAgYXJpYS12YWx1ZW1pbj1cIjBcIlxuICBhcmlhLXZhbHVlbWF4PVwiMTAwXCJcbiAgW2F0dHIuYXJpYS12YWx1ZXRleHRdPVwibG9hZGluZ1RleHRcIlxuICByb2xlPVwicHJvZ3Jlc3NiYXJcIlxuICB0YWJpbmRleD1cIi0xXCJcbiAgW25nQ2xhc3NdPVwie1xuICAgICdjdXN0b20tY29udGVudCc6IGFwcGVhcmFuY2UgPT09ICdjdXN0b20tY29udGVudCcsXG4gICAgY2lyY2xlOiBhcHBlYXJhbmNlID09PSAnY2lyY2xlJyxcbiAgICBwcm9ncmVzczogYW5pbWF0aW9uID09PSAncHJvZ3Jlc3MnLFxuICAgICdwcm9ncmVzcy1kYXJrJzogYW5pbWF0aW9uID09PSAncHJvZ3Jlc3MtZGFyaycsXG4gICAgcHVsc2U6IGFuaW1hdGlvbiA9PT0gJ3B1bHNlJ1xuICB9XCJcbiAgW25nU3R5bGVdPVwidGhlbWVcIlxuPlxuICA8bmctY29udGVudCAqbmdJZj1cImFwcGVhcmFuY2UgID09PSAnY3VzdG9tLWNvbnRlbnQnXCI+PC9uZy1jb250ZW50PlxuPC9kaXY+XG4iXX0=